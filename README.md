
# Лабораторная работа: Моделирование квантовых гейтов и операций над кубитами

## Цель

Реализовать и исследовать:

- Класс для представления кубита
- Однокубитные гейты Паули (X, Y, Z)
- Двухкубитный гейт CNOT
- Визуализацию вероятностей состояний кубита

---

## Теория
### Кубит

Кубит — это суперпозиция двух базисных состояний: |ψ⟩ = α|0⟩ + β|1⟩

Где:
- α и β — комплексные числа
- |α|² + |β|² = 1 — условие нормализации

Измерение кубита даёт:
- 0 с вероятностью |α|²
- 1 с вероятностью |β|²

### Квантовые гейты

Квантовые гейты — это унитарные матрицы. Применяются как: |ψ'⟩ = U |ψ⟩
#### ▪️ Гейты Паули

| Название | Матрица |
|----------|---------|
| Pauli-X  | `[[0, 1], [1, 0]]` |
| Pauli-Y  | `[[0, -i], [i, 0]]` |
| Pauli-Z  | `[[1, 0], [0, -1]]` |

#### ▪️ Гейт CNOT (2 кубита)

CNOT (Controlled-NOT) работает с двумя кубитами:

- первый — **контролирующий**

- второй — **целевой**

Если первый кубит равен |1⟩, второй инвертируется.

CNOT = | `[[1, 0, 0, 0],
[0, 1, 0, 0],
[0, 0, 0, 1],
[0, 0, 1, 0]]` |

---



# Реализация

## Класс `Qubit`

Работает с парой кубитов. Состояние представляется как тензорное произведение: |ψ₁⟩ ⊗ |ψ₂⟩ = |ψ₁ψ₂⟩

```python
q = Qubit(1, 0)  # Инициализация кубита в базовом состоянии |0⟩
print(q)         # Вывод состояния в читаемом виде, например "1.00|0⟩ + 0.00|1⟩"
```

Метод `apply_gate(gate_matrix)` позволяет применить произвольный одно-кубитный унитарный оператор (гейт), реализованный в виде матрицы 2×2.

Метод `measure()` моделирует квантовое измерение, возвращая результат (0 или 1) с вероятностями, пропорциональными квадратам амплитуд.

Метод `__str__()` формирует удобочитаемое текстовое представление состояния кубита.

## Гейты Паули

Гейты Паули реализованы как отдельные функции, возвращающие унитарные матрицы 2×2, которые изменяют состояние кубита:

```python
def pauli_x():
    return np.array([[0, 1],
                     [1, 0]], dtype=complex)
```

Pauli-X действует как квантовый эквивалент классического NOT — меняет местами |0⟩ и |1⟩.

Аналогично реализованы Pauli-Y и Pauli-Z, которые меняют фазы и амплитуды, обеспечивая базовые операции над кубитом.

Использование этих гейтов демонстрирует, как можно управлять состоянием кубита для создания нужных квантовых суперпозиций и фазовых сдвигов.

## Гейт Адамара (Hadamard)

Гейт Адамара преобразует базисные состояния |0⟩ и |1⟩ в равновероятные суперпозиции:

```python
def hadamard():
    return (1 / np.sqrt(2)) * np.array([[1, 1],
                                        [1, -1]], dtype=complex)
```

Используется для подготовки кубита в состояние суперпозиции, что является фундаментом квантовых алгоритмов.

## Класс QubitPair

Класс `QubitPair` объединяет два кубита в общее состояние через тензорное произведение их векторов состояний.

```python
q1 = Qubit(1, 0)  # Первый кубит в состоянии |0⟩
q2 = Qubit(0, 1)  # Второй кубит в состоянии |1⟩
pair = QubitPair(q1, q2)  # Объединение в пару кубитов
pair.apply_gate(cnot())    # Применение двухкубитного CNOT-гейта
print(pair)               # Вывод состояния пары, например "0.00|00⟩ + 0.00|01⟩ + 1.00|10⟩ + 0.00|11⟩"
```

Метод `apply_gate` принимает матрицу 4×4, реализующую двухкубитный гейт (например, CNOT).

Это позволяет моделировать запутанные состояния и сложные операции над квантовой системой из двух кубитов.

## Гейт CNOT (Controlled-NOT)

```python
def cnot():
    return np.array([
        [1, 0, 0, 0],  # |00⟩ → |00⟩
        [0, 1, 0, 0],  # |01⟩ → |01⟩
        [0, 0, 0, 1],  # |10⟩ → |11⟩
        [0, 0, 1, 0]   # |11⟩ → |10⟩
    ], dtype=complex)
```

CNOT инвертирует второй кубит, если первый находится в состоянии |1⟩.

Гейт используется для создания запутанных состояний, которые являются основой квантовых вычислений и криптографии.

## Визуализация

Для наглядного отображения состояния кубитов и пар кубитов используются функции визуализации:

```python
visualize_qubit(q, "Состояние кубита")
```

Функция `visualize_qubit` отображает вероятности измерения состояний |0⟩ и |1⟩ в виде столбчатой диаграммы с числовыми подписями.

Для пары кубитов применяется функция `visualize_pair`, которая показывает вероятности состояний |00⟩, |01⟩, |10⟩, |11⟩.

Визуализация помогает понять влияние различных гейтов на распределение вероятностей и убедиться в корректности операций.

## Визуализация состояний кубитов и пар кубитов
Для наглядного анализа состояний одиночных кубитов и их пар в данной работе использованы функции визуализации, реализованные на основе библиотеки matplotlib. Они помогают увидеть распределение вероятностей измерения различных базисных состояний и убедиться в корректности применения квантовых гейтов.

### Визуализация состояния одиночного кубита — функция visualize_qubit
Функция `visualize_qubit(qubit, title)` принимает объект класса Qubit и отображает вероятности измерения состояний |0⟩ и |1⟩ в виде столбчатой диаграммы.

- Вероятности вычисляются как квадрат модулей амплитуд вектора состояния кубита.

- Для визуализации используются два столбца с подписями "|0⟩" и "|1⟩".

- Над каждым столбцом выводится числовое значение вероятности с точностью до двух знаков после запятой.

- Диаграмма ограничена по оси Y диапазоном от 0 до 1, что соответствует диапазону вероятностей.

Такая визуализация позволяет наблюдать, как квантовые гейты (например, Паули X, Y, Z или гейт Адамара) изменяют амплитуды и вероятности состояний кубита.

#### Пример визуализации:

Начальное состояние кубита |0⟩
![изображение](https://github.com/user-attachments/assets/48e32473-0bd6-49e7-afc5-cd0e2092ad6b)

После применения гейта Паули X (инверсия состояний)
![изображение](https://github.com/user-attachments/assets/d3b415f0-ae4f-4376-baea-987474c39559)


После применения гейта Паули Y 
![изображение](https://github.com/user-attachments/assets/b4d8eb29-5a17-4332-ad6a-262ed0795b17)

После применения гейта Паули Z
![изображение](https://github.com/user-attachments/assets/1c89d993-0cd5-4c09-8795-2475495d016d)

После применения гейта Адамара (суперпозиция)
![изображение](https://github.com/user-attachments/assets/9af8c885-96a1-4f6c-9ec6-c08a36deb1b0)


### Визуализация состояния пары кубитов — функция visualize_pair
Функция `visualize_pair(state_vector, title)` отображает вероятности измерения четырёх возможных базисных состояний двух кубитов: |00⟩, |01⟩, |10⟩ и |11⟩.

- Вероятности вычисляются как квадрат модуля каждого элемента вектора состояния пары кубитов.

- Визуализация проводится с помощью четырёх столбцов с соответствующими подписями.

- Числовые значения вероятностей также отображаются над столбцами.

- Диаграмма ограничена по оси Y диапазоном от 0 до 1.

Эта визуализация особенно полезна для наблюдения явлений запутанности и изменения состояний под воздействием двухкубитных гейтов, таких как CNOT.

#### Пример визуализации:


Запутанное состояние типа Белла, полученное после применения H к первому кубиту и CNOT к паре
![изображение](https://github.com/user-attachments/assets/e8936dfb-593d-4ae0-9269-c3af383a7f41)


Заключение
Использование функций visualize_qubit и visualize_pair значительно облегчает понимание изменения квантовых состояний под действием различных гейтов. На основе визуализаций можно проверить корректность математической реализации квантовых операций и убедиться в получении ожидаемых квантовых суперпозиций и запутанностей.

## Выводы

- В ходе реализации были успешно реализованы основные одно-кубитные гейты Паули (X, Y, Z) и двухкубитный гейт CNOT, что позволило моделировать базовые операции квантовых вычислений на уровне амплитуд состояний.
- Гейты Паули X и Y эффективно меняют амплитуды и фазы состояний кубита, что приводит к изменению вероятностей измерения. Гейт Z не изменяет вероятности, но меняет фазу амплитуды, что критично для интерференционных эффектов в последующих операциях.
- Гейт Адамара (H) позволяет создавать суперпозиции и, в сочетании с CNOT, формировать запутанные состояния, что подтверждается результатами измерений и изменением распределения вероятностей.
- Применение гейта CNOT к паре кубитов моделирует классическую логику управления — инверсию второго кубита при состоянии первого равном 1, что является основой для квантовых алгоритмов и создания запутанности.
- Визуализация вероятностей состояний после применения гейтов показывает, как квантовые операции трансформируют состояние системы, однако фазовые сдвиги (например, от Z-гейта) не влияют напрямую на вероятности и не видны в измерениях, но играют ключевую роль при последовательном применении гейтов.
- Моделирование измерения кубитов и пар кубитов демонстрирует коллапс волновой функции и случайность результата с вероятностями, соответствующими квадрату модуля амплитуд — что соответствует теоретическим ожиданиям квантовой механики.
- Реализованные классы и методы обеспечивают удобную и наглядную платформу для изучения базовых принципов квантовых вычислений и экспериментирования с разными комбинациями гейтов.

---
